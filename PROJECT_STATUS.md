# ゆるっとミツ確 - プロジェクト進捗状況

**最終更新**: 2026-01-29

## プロジェクト概要

Web制作の見積もりシミュレーター「ゆるっとミツ確」の実装プロジェクト。
- **目的**: 営業なし・匿名でWeb制作の確定価格をその場で算出
- **技術スタック**: Next.js 16.1.5, React 19, TypeScript, Tailwind CSS
- **デプロイ予定**: Vercel
- **リポジトリ**: https://github.com/runnpappa0/yurutto-mitsukaku

## 完成した機能

### ✅ UI/UX実装（100%完了）

#### 1. ヒアリングフォーム（6ステップ）
- **STEP 01**: 目的選択（6項目のラジオボタン）
- **STEP 02**: 業種選択（13項目のラジオボタン + 「その他」入力欄）
- **STEP 03**: デザインイメージ（7項目のラジオボタン）
- **STEP 04**: 必要なページ（トグルスイッチ + カウンター）
  - トップページ（デフォルトON、固定）
  - お問い合わせ（選択可能）
  - 追加ページ9項目（トグル）
  - その他ページ数（0〜10のカウンター）
- **STEP 05**: ブログ機能（トグル + カウンター）
  - 4項目のトグル + その他カウンター
- **STEP 06**: ギャラリー機能（トグル + カウンター）
  - 5項目のトグル + その他カウンター

**実装済みUI要素**:
- サブラベル機能（トップページ: セクション数無制限、スタッフ紹介: 固定表示/複数名管理）
- 入力リセットボタン
- リアルタイム選択済みページ数カウント
- レスポンシブ対応（スマホ/タブレット/デスクトップ）
- バリデーション（業種「その他」選択時の必須入力）

#### 2. 見積もり計算画面
- ローディングアニメーション（2秒間）
- スピナーアイコン

#### 3. 結果画面
- 見積もり総額表示（大きく強調）
- 選択した構成の一覧表示
  - 選択ページ
  - ブログ機能
  - ギャラリー機能
- お見積もりの前提条件表示
  - 目的、業種、デザイン
- 「料金に含まれるもの」モーダル
  - ?アイコンクリックで開く
  - 7項目の詳細説明（2カラムグリッド）
  - モバイル最適化
- ホスティング費用の注釈

#### 4. 相談依頼フォーム
- 必須項目
  - お名前（2文字以上）
  - メールアドレス（正規表現バリデーション）
- 任意項目
  - 既存サイトURL（URL形式バリデーション）
  - パンフレット・チラシ（最大5ファイル、各5MB以内）
  - 参考サイト×3（URL形式バリデーション）
  - 追加のご要望（500文字以内、文字数カウンター）
- バリデーション
  - フォーカスが離れた時のみエラー表示
  - 一度エラーが表示されたらリアルタイムバリデーション
  - 送信ボタン押下時に全フィールドチェック
  - エラーメッセージはプライマリカラー（#de5361）

#### 5. 送信完了画面
- チェックマークアイコン
- 完了メッセージ
- サービスページへ戻るボタン
  - リンク先: https://mitsukaku.studio.site

### ✅ 価格計算ロジック（100%完了）

**ファイル**: `app/utils/priceCalculator.ts`

**計算式**:
- 基本料金: ¥50,000（トップページ + お問い合わせフォーム）
- 追加ページ: （選択数 + その他カウンター）× ¥10,000
- ブログ機能:
  - 選択数0: ¥0
  - 選択数1: ¥20,000
  - 選択数2以降: ¥20,000 + (count - 1) × ¥10,000
- ギャラリー機能:
  - 選択数0: ¥0
  - 選択数1: ¥20,000
  - 選択数2以降: ¥20,000 + (count - 1) × ¥25,000

**例**: 追加ページ3つ + ブログ2種類 + ギャラリー3種類
= ¥50,000 + ¥30,000 + ¥30,000 + ¥70,000 = **¥180,000**

### ✅ デザインシステム

**カラーパレット**:
- Primary: #de5361（赤/ピンク系）
- Secondary: #2d4259（濃紺）
- Background: #fcfcfc（ドット背景）

**フォント**:
- Noto Sans JP（Google Fonts）

**UIパターン**:
- 角丸: rounded-[40px]（カード）、rounded-2xl（ボタン）
- シャドウ: shadow-[0_10px_30px_-5px_rgba(0,0,0,0.05)]
- アニメーション: fadeIn, fadeInUp
- ボトムバー: sticky, z-40

**レスポンシブ**:
- モバイルファースト設計
- ブレークポイント: md（768px以上）

### ✅ ファビコン
- `app/app/icon.svg` に配置
- 自動的にブラウザタブに表示

### ✅ リファクタリング実施済み
- 未使用のphoneフィールド削除
- Legacyコメント削除
- 未使用CSS削除
- Next.jsデフォルトSVGファイル削除（5ファイル）
- インラインスタイルのグローバルクラス統一

## 進行中の機能

### 🚧 フォーム送信機能（準備中）

**実装方針**:
1. Google Apps Script（GAS）でWebアプリを作成
2. Next.jsからGASにPOSTリクエスト
3. GAS側で以下を実行:
   - 管理者へメール送信（優先処理）
   - レスポンスを返す（ユーザーは待たない）
   - 非同期でGoogleスプレッドシートに記録
   - 添付ファイルをGoogleドライブに保存

**準備済み**:
- ✅ スプレッドシート設計書（`scripts/spreadsheet-design.md`）
- ✅ GAS実行用コード（`scripts/gas-create-spreadsheet.js`）
  - スプレッドシート自動作成
  - ヘッダー行フォーマット（背景色 #2d4259）
  - 固定行・列設定
  - ステータスドロップダウン（未対応/対応中/完了）
  - 金額列の通貨形式
  - 交互背景色

**スプレッドシート設計（23列）**:
```
A: 受信日時
B: ステータス
C: お名前
D: メールアドレス
E: 目的
F: 業種
G: 業種詳細
H: デザインスタイル
I: 選択ページ一覧
J: ページ数
K: ブログ機能
L: ギャラリー機能
M: 基本料金
N: 追加ページ料金
O: ブログ機能料金
P: ギャラリー機能料金
Q: 見積もり総額（税別）
R: 既存サイトURL
S: 参考サイト1
T: 参考サイト2
U: 参考サイト3
V: 添付ファイル（Googleドライブリンク）
W: 追加のご要望
```

**次のステップ**:
1. GASで `createFormattedSpreadsheet()` を実行
2. スプレッドシートIDを取得
3. GASでフォーム送信APIを実装
4. Next.js側で送信処理を実装

## 未実装の機能

### ❌ バックエンド
- [ ] フォーム送信API（GAS）
- [ ] メール送信機能（GAS Gmail API）
- [ ] スプレッドシート記録（GAS Sheets API）
- [ ] ファイルアップロード（GAS Drive API）

### ❌ デプロイ
- [ ] Vercelへのデプロイ
- [ ] 環境変数の設定
- [ ] カスタムドメインの設定

### ❌ その他
- [ ] OGP画像
- [ ] メタディスクリプションの最適化
- [ ] Google Analytics設定

## ファイル構成

```
app/
├── app/
│   ├── app/
│   │   ├── page.tsx              # メイン画面遷移・状態管理
│   │   ├── layout.tsx            # レイアウト・メタデータ
│   │   ├── globals.css           # グローバルスタイル
│   │   └── icon.svg              # ファビコン
│   ├── components/
│   │   ├── HearingForm.tsx       # ヒアリングフォーム（6ステップ）
│   │   ├── CalculatingScreen.tsx # 計算中画面
│   │   ├── ResultScreen.tsx      # 結果画面
│   │   ├── ConsultationForm.tsx  # 相談依頼フォーム
│   │   └── CompletionScreen.tsx  # 送信完了画面
│   ├── utils/
│   │   └── priceCalculator.ts    # 価格計算ロジック
│   ├── public/
│   │   └── mitsukaku_logo.svg    # ロゴ
│   └── scripts/
│       ├── spreadsheet-design.md        # 手動作成用設計書
│       ├── gas-create-spreadsheet.js    # GAS実行用コード
│       ├── createSpreadsheet.js         # Node.js実行用（使わない）
│       ├── README.md                     # セットアップガイド
│       └── credentials.example.json     # 認証情報テンプレート
```

## 重要な設定値

### デザイン
- Primary Color: `#de5361`
- Secondary Color: `#2d4259`
- Background: `#fcfcfc` + ドットパターン
- Font: Noto Sans JP

### 価格
- 基本料金: ¥50,000
- 追加ページ: ¥10,000/ページ
- ブログ機能（初回）: ¥20,000
- ブログ機能（追加）: ¥10,000/種類
- ギャラリー機能（初回）: ¥20,000
- ギャラリー機能（追加）: ¥25,000/種類

### リンク
- サービスページ: https://mitsukaku.studio.site
- GitHub: https://github.com/runnpappa0/yurutto-mitsukaku

### コピーライト
- © 2026 studio earth signs

## Git履歴（最近のコミット）

```
23e8871 - feat: GASで実行可能なスプレッドシート作成コードを追加
71274c2 - docs: スプレッドシート手動作成用の設計書を追加
7a15eab - feat: スプレッドシート作成スクリプトを追加
9935c87 - style: 送信完了画面のビックリマークを削除
d4a5db1 - feat: バリデーションUXをさらに改善
a9443b9 - feat: 入力完了時のみバリデーションエラーを表示
eed9dc7 - style: エラーメッセージの色をプライマリカラーに変更
4e6be90 - refactor: 業種詳細のエラーメッセージを削除
7222837 - refactor: ヒアリングフォームのエラーメッセージ表示を削除
7a16794 - feat: 全入力項目に詳細なバリデーションチェックを実装
069fe6c - refactor: 未使用コードとファイルを削除
92c72a4 - feat: 完了画面にサービスページへ戻るボタンを追加
bb0d904 - feat: 結果画面に「料金に含まれるもの」モーダルを追加
1b0f3a8 - fix: アイコンを再度更新
92c43b3 - fix: 修正されたアイコンに差し替え
695eba9 - fix: icon.svgを正しい場所に配置してファビコンを更新
d0b5df0 - feat: スタッフ紹介とトップページにサブラベルを追加
```

## 今後の開発フロー

### 次のステップ（フォーム送信機能）

1. **スプレッドシート作成**
   ```
   1. script.google.com を開く
   2. gas-create-spreadsheet.js をコピペ
   3. createFormattedSpreadsheet() を実行
   4. スプレッドシートIDをメモ
   ```

2. **GAS Webアプリ作成**
   ```
   - doPost() 関数を実装
   - メール送信処理
   - スプレッドシート記録
   - ファイルアップロード
   ```

3. **Next.js側の実装**
   ```
   - ConsultationForm.tsx にPOST処理追加
   - ファイルのBase64エンコード
   - ローディング表示
   - エラーハンドリング
   ```

4. **テスト**
   ```
   - 送信テスト
   - メール受信確認
   - スプレッドシート記録確認
   - ファイルアップロード確認
   ```

5. **デプロイ**
   ```
   - Vercel連携
   - 環境変数設定
   - 本番確認
   ```

## 開発メモ

### 技術的な判断
- **状態管理**: useState（シンプルで十分）
- **フォームバリデーション**: onBlur + リアルタイム（UX重視）
- **エラー表示**: プライマリカラー（統一感）
- **送信処理**: GAS（無料、サーバーレス、高信頼性）

### UX改善の履歴
- ボタン非活性化のみでエラーメッセージ削除（シンプル化）
- 入力途中のエラー表示を削除（ストレス軽減）
- 一度エラーが出たらリアルタイムバリデーション（修正確認）
- 文字数カウンター表示（わかりやすさ）

### デザイン調整の履歴
- モーダルを2カラムに変更（コンパクト）
- ?アイコンを目立たせる（視認性向上）
- エラーメッセージの色を統一（一貫性）
- フロートバーのレスポンシブ最適化（モバイル対応）

## 連絡先・権限

### 必要な情報（未設定）
- [ ] 管理者メールアドレス（通知先）
- [ ] スプレッドシートID
- [ ] GAS WebアプリURL

### サービスアカウント（未作成）
- [ ] Google Cloud Console プロジェクト作成
- [ ] サービスアカウント作成
- [ ] スプレッドシート編集権限付与

## 問題・課題

### 既知の問題
- なし（現時点で確認されている問題はなし）

### 制約事項
- ファイルアップロード: 最大5MB × 5ファイル
- 追加要望: 500文字以内
- その他カウンター: 0〜10の範囲

## 参考リンク

- [Next.js Documentation](https://nextjs.org/docs)
- [Tailwind CSS](https://tailwindcss.com/)
- [Google Apps Script](https://developers.google.com/apps-script)
- [Google Sheets API](https://developers.google.com/sheets/api)

---

**このファイルは次のコンテキストで作業を再開する際の参照用です。**
**最新の状態を常に反映してください。**
