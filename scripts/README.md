# スプレッドシート作成ガイド

このスクリプトは、ゆるっとミツ確の相談依頼データを管理するためのGoogleスプレッドシートを自動作成します。

## セットアップ手順

### 1. Google Cloud Consoleの設定

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. 新しいプロジェクトを作成
   - プロジェクト名: `yurutto-mitsukaku`
3. 「APIとサービス」→「ライブラリ」から以下を有効化:
   - **Google Sheets API**
   - **Google Drive API**

### 2. サービスアカウントの作成

1. 「APIとサービス」→「認証情報」
2. 「認証情報を作成」→「サービスアカウント」
3. サービスアカウント情報を入力:
   - 名前: `yurutto-mitsukaku-service`
   - 説明: `ゆるっとミツ確のフォーム送信用`
4. 「完了」をクリック
5. 作成したサービスアカウントをクリック
6. 「キー」タブ→「鍵を追加」→「新しい鍵を作成」
7. 「JSON」を選択してダウンロード
8. ダウンロードしたJSONファイルを `scripts/credentials.json` として保存

### 3. 依存関係のインストール

```bash
npm install googleapis
```

### 4. スクリプト実行

```bash
node scripts/createSpreadsheet.js
```

実行すると:
- ✅ スプレッドシートが作成される
- ✅ ヘッダー行、色、列幅などが自動設定される
- ✅ `spreadsheet-config.json` に設定が保存される
- ✅ スプレッドシートのURLとIDがコンソールに表示される

### 5. 権限設定

1. コンソールに表示されたスプレッドシートURLをブラウザで開く
2. 「共有」ボタンをクリック
3. サービスアカウントのメールアドレス（`xxx@xxx.iam.gserviceaccount.com`）を追加
4. 権限を「編集者」に設定

## スプレッドシート仕様

### 列構成

| 列 | 項目 | 幅 | 説明 |
|---|---|---|---|
| A | 受信日時 | 160px | 自動記録 |
| B | ステータス | 100px | ドロップダウン（未対応/対応中/完了） |
| C | お名前 | 120px | - |
| D | メールアドレス | 200px | - |
| E | 目的 | 150px | - |
| F | 業種 | 120px | - |
| G | 業種詳細 | 150px | - |
| H | デザインスタイル | 120px | - |
| I | 選択ページ一覧 | 300px | カンマ区切り |
| J | ページ数 | 80px | 数値 |
| K | ブログ機能 | 200px | カンマ区切り |
| L | ギャラリー機能 | 200px | カンマ区切り |
| M | 基本料金 | 100px | 通貨形式 |
| N | 追加ページ料金 | 120px | 通貨形式 |
| O | ブログ機能料金 | 120px | 通貨形式 |
| P | ギャラリー機能料金 | 140px | 通貨形式 |
| Q | 見積もり総額（税別） | 140px | 通貨形式 |
| R | 既存サイトURL | 250px | URL |
| S | 参考サイト1 | 250px | URL |
| T | 参考サイト2 | 250px | URL |
| U | 参考サイト3 | 250px | URL |
| V | 添付ファイル | 300px | Googleドライブリンク |
| W | 追加のご要望 | 400px | テキスト |

### デザイン

- **ヘッダー行**: 背景色 #2d4259（セカンダリカラー）、白文字、太字
- **固定**: ヘッダー行 + 受信日時・ステータス列（スクロールしても見える）
- **交互背景色**: 偶数行に薄いグレー
- **ステータス**: ドロップダウンで選択可能
- **金額**: 通貨形式（¥記号 + カンマ区切り）

## トラブルシューティング

### エラー: credentials.json が見つからない
- サービスアカウントのJSONキーを `scripts/credentials.json` として保存してください

### エラー: Google Sheets API が無効
- Google Cloud ConsoleでGoogle Sheets APIを有効化してください

### エラー: 権限がない
- スプレッドシート作成後、サービスアカウントに編集権限を付与してください

## 次のステップ

スプレッドシート作成後:
1. `spreadsheet-config.json` からスプレッドシートIDをコピー
2. GASコードにスプレッドシートIDを設定
3. フォーム送信機能の実装に進む
