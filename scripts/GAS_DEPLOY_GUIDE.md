# GAS Webアプリ デプロイガイド

このガイドに従って、フォーム送信機能のGAS Webアプリをデプロイします。

## ステップ1: GASプロジェクト作成

1. https://script.google.com/ にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を「ゆるっとミツ確 API」に変更

## ステップ2: コードの貼り付け

1. `scripts/gas-form-handler.js` の内容を全てコピー
2. GASエディタの `Code.gs` に貼り付け
3. 💾 保存（Ctrl+S / Cmd+S）

## ステップ3: テストメール送信（オプション）

動作確認のため、テストメールを送信してみましょう。

1. 関数選択ドロップダウンから `testEmail` を選択
2. 「実行」ボタンをクリック
3. 初回実行時、権限の承認を求められます:
   - 「権限を確認」をクリック
   - Googleアカウントを選択
   - 「詳細」→「ゆるっとミツ確 API（安全ではないページ）に移動」
   - 「許可」をクリック
4. 実行ログを確認: 「✅ テストメール送信完了」
5. メールボックスを確認:
   - `studio.earthsigns@gmail.com` と `lin_xiaoling10@yahoo.co.jp` にテストメールが届いているか確認

## ステップ4: Webアプリとしてデプロイ

1. 右上の「デプロイ」→「新しいデプロイ」をクリック
2. 設定:
   - **種類**: 「ウェブアプリ」を選択
   - **説明**: 「初回デプロイ」
   - **次のユーザーとして実行**: 「自分（あなたのメールアドレス）」
   - **アクセスできるユーザー**: 「全員」⚠️ 重要！
3. 「デプロイ」をクリック
4. **WebアプリのURL**をコピー
   - 形式: `https://script.google.com/macros/s/xxxxx/exec`
   - このURLは後でNext.js側で使用します

## ステップ5: URLの保存

WebアプリのURLをメモしてください:

```
https://script.google.com/macros/s/【ここは人によって異なる】/exec
```

## ステップ6: スプレッドシートの確認

1. スプレッドシートを開く:
   https://docs.google.com/spreadsheets/d/1JdIACemS4miy50cQZfjjeE8qUkMN7_yy6KdR0h-HhsA/edit

2. シート名が「相談依頼」になっているか確認

3. ヘッダー行が正しく設定されているか確認

## トラブルシューティング

### エラー: "Exception: Unexpected error while getting the method or property appendRow on object Sheet"
- スプレッドシートIDが正しいか確認
- シート名「相談依頼」が存在するか確認

### テストメールが届かない
- Gmail の設定で「安全性の低いアプリのアクセス」が有効か確認
- スパムフォルダを確認

### デプロイ時のエラー
- 「アクセスできるユーザー」が「全員」になっているか確認
- GASのAPIサービスが有効か確認

## 次のステップ

GAS Webアプリのデプロイが完了したら:

1. **WebアプリのURL**をコピー
2. Next.js側のコードに貼り付け
3. フォーム送信機能をテスト

---

**WebアプリのURLを取得したら、次のステップに進んでください。**
